<!DOCTYPE html>
<html>
  <head><meta charset="utf-8" />
  <title>Intro To Experiment Containers </title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<style type="text/css">
.highlight{background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .1em;padding:0em .5em;border-radius: 4px;}
.k{color: #338822; font-weight: bold;}
.kn{color: #338822; font-weight: bold;}
.mi{color: #000000;}
.o{color: #000000;}
.ow{color: #BA22FF;  font-weight: bold;}
.nb{color: #338822;}
.n{color: #000000;}
.s{color: #cc2222;}
.se{color: #cc2222; font-weight: bold;}
.si{color: #C06688; font-weight: bold;}
.nn{color: #4D00FF; font-weight: bold;}
</style>
  <!-- Custom stylesheet, it must be in the same directory as the html file -->
<!--   <link rel="stylesheet" href="../../../../../main_template_layouts/css/jupyter_notebook_styles.css"> -->
<!--   {% load staticfiles %}
  <link rel="stylesheet" type="text/css" href="{% static 'brain_observatory_app/css/jupyter_notebook_styles.css' %}"> -->

  <!-- Loading mathjax macro -->
  <!-- Load mathjax -->
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      <!-- MathJax configuration -->
      <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
              processEnvironments: true
          },
          // Center justify equations in code and markdown cells. Elsewhere
          // we use CSS to left justify single line equations in code cells.
          displayAlign: 'center',
          "HTML-CSS": {
              styles: {'.MathJax_Display': {"margin": 0}},
              linebreaks: { automatic: true }
          }
      });
      </script>
      <!-- End of mathjax configuration --></head>
  <body>
    <div tabindex="-1" id="notebook" class="border-box-sizing">
      <div class="container" id="notebook-container">

  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h2 id="Intro-To-Experiment-Containers-">Intro To Experiment Containers <a class="anchor-link" href="#Intro-To-Experiment-Containers-"></a></h2><p>In this tutorial, you will learn :</p>
  <ol>
  <li>Retrieving all <strong>Experiment Containers</strong></li>
  <li>Accessing info in an <strong>Experiment Container</strong></li>
  <li>Retrieving <strong>Experiment Containers</strong> matching specific criteria</li>
  </ol>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started"></a></h4><p>Be sure you've installed the <em>Allen SDK Package</em>.</p>
  <p>If you haven't, follow this link: <a href="http://alleninstitute.github.io/AllenSDK/install.html">Allen SDK Package Installation</a></p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="Import-Libraries-">Import Libraries <a class="anchor-link" href="#Import-Libraries-"></a></h4><p>Let's begin by importing The neccessary Libraries. They are as follows:</p>
  <ul>
  <li><strong>BrainObservatoryCache</strong> contains functions for accessing and parsing our data </li>
  <li><strong>pprint</strong> for formatting our data, making it easy to read</li>
  </ul>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[1]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">allensdk.core.brain_observatory_cache</span><span class="kn">import</span> <span class="n">BrainObservatoryCache</span>
  <span class="kn">import</span> <span class="nn">pprint</span> 
  </pre></div>

  </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="1.-Retrieve-All-Experiment-Containers-">1. Retrieve All Experiment Containers <a class="anchor-link" href="#1.-Retrieve-All-Experiment-Containers-"></a></h4><p>We will start our data retrieval by initializing the variable <em>boc</em> as a <strong>BrainObservatoryCache</strong> object.</p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[2]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">boc</span> <span class="o">=</span> <span class="n">BrainObservatoryCache</span><span class="p">(</span><span class="n">manifest_file</span><span class="o">=</span><span class="s1">&#39;boc/manifest.json&#39;</span><span class="p">)</span>
  </pre></div>

  </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <p><em>boc</em> will now serve as a location to store the information about our <strong>Experiment Containers</strong>.</p>
  <p>We can now retrieve the <strong>Experiment Containers</strong> by calling the <em>get_experiment_containers()</em> method from the <strong>BrainObservatoryCache</strong> class.</p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[3]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">all_experiment_containers</span> <span class="o">=</span> <span class="n">boc</span><span class="o">.</span><span class="n">get_experiment_containers</span><span class="p">()</span>
  </pre></div>

  </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <p>Let's print the contents of <em>all_experiment_containers</em> using <strong>pprint</strong>.</p>
  <p>Take note of the following:</p>
  <ul>
  <li>The data is a [list] containing many {JSON objects} </li>
  <li>Each JSON object represents an <strong>Experiment Container</strong></li>
  </ul>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[4]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">all_experiment_containers</span><span class="p">)</span>
  </pre></div>

  </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area"><div class="prompt"></div>
  <div class="output_subarea output_stream output_stdout output_text">
  <pre>[{&#39;cre_line&#39;: u&#39;Cux2-CreERT2&#39;,
    &#39;donor_name&#39;: u&#39;283284&#39;,
    &#39;failed&#39;: False,
    &#39;id&#39;: 566759225,
    &#39;imaging_depth&#39;: 275,
    &#39;reporter_line&#39;: u&#39;Ai93(TITL-GCaMP6f)&#39;,
    &#39;specimen_name&#39;: u&#39;Cux2-CreERT2;Camk2a-tTA;Ai93-283284&#39;,
    &#39;tags&#39;: [],
    &#39;targeted_structure&#39;: u&#39;VISam&#39;},
   {&#39;cre_line&#39;: u&#39;Nr5a1-Cre&#39;,
    &#39;donor_name&#39;: u&#39;261969&#39;,
    &#39;failed&#39;: False,
    &#39;id&#39;: 546328009,
    &#39;imaging_depth&#39;: 350,
    &#39;reporter_line&#39;: u&#39;Ai93(TITL-GCaMP6f)&#39;,
    &#39;specimen_name&#39;: u&#39;Nr5a1-Cre;Camk2a-tTA;Ai93-261969&#39;,
    &#39;tags&#39;: [],
    &#39;targeted_structure&#39;: u&#39;VISal&#39;},
   {&#39;cre_line&#39;: u&#39;Scnn1a-Tg3-Cre&#39;,
    &#39;donor_name&#39;: u&#39;230570&#39;,
    &#39;failed&#39;: False,
    &#39;id&#39;: 511510911,
    &#39;imaging_depth&#39;: 350,
    &#39;reporter_line&#39;: u&#39;Ai93(TITL-GCaMP6f)&#39;,
    &#39;specimen_name&#39;: u&#39;Scnn1a-Tg3-Cre;Camk2a-tTA;Ai93-230570&#39;,
    &#39;tags&#39;: [],
    &#39;targeted_structure&#39;: u&#39;VISp&#39;},
   {&#39;cre_line&#39;: u&#39;Emx1-IRES-Cre&#39;,
    &#39;donor_name&#39;: u&#39;284669&#39;,
    &#39;failed&#39;: False,
    &#39;id&#39;: 569792815,
    &#39;imaging_depth&#39;: 375,
    &#39;reporter_line&#39;: u&#39;Ai93(TITL-GCaMP6f)&#39;,
    &#39;specimen_name&#39;: u&#39;Emx1-IRES-Cre;Camk2a-tTA;Ai93-284669&#39;,
    &#39;tags&#39;: [],
    &#39;targeted_structure&#39;: u&#39;VISam&#39;}]
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="2.-Access-The-Info-In-An-Experiment-Container">2. Access The Info In An Experiment Container<a class="anchor-link" href="#2.-Access-The-Info-In-An-Experiment-Container"></a></h4><p>We can retrieve a single <strong>Experiment Container</strong> by using its respective index value within the list.</p>
  <p>Below we will create a variable called <em>experiment_container_one</em>, and assign it to the first <strong>Experiment Container</strong> within  <em>all_experiment_containers</em> list.</p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[5]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">experiment_container_one</span> <span class="o">=</span> <span class="n">all_experiment_containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  </pre></div>

  </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <p>Let's print the contents of <em>experiment_container_one</em> using <strong>pprint</strong>.</p>
  <p>Take Note of the following:</p>
  <ul>
  <li>This is a single JSON object </li>
  <li>A single <strong>Experiment Container</strong> contains 10 keys/value pairs</li>
  </ul>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[6]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">experiment_container_one</span><span class="p">)</span>
  </pre></div>

  </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area"><div class="prompt"></div>
  <div class="output_subarea output_stream output_stdout output_text">
  <pre>{&#39;cre_line&#39;: u&#39;Cux2-CreERT2&#39;,
   &#39;donor_name&#39;: u&#39;283284&#39;,
   &#39;failed&#39;: False,
   &#39;id&#39;: 566759225,
   &#39;imaging_depth&#39;: 275,
   &#39;reporter_line&#39;: u&#39;Ai93(TITL-GCaMP6f)&#39;,
   &#39;specimen_name&#39;: u&#39;Cux2-CreERT2;Camk2a-tTA;Ai93-283284&#39;,
   &#39;tags&#39;: [],
   &#39;targeted_structure&#39;: u&#39;VISam&#39;}
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <p>For each key in the experiment container, we can retrieve its corresponding value by using <em>experiment_container_one ['key']</em>.</p>
  <p>Try printing some of the values in the cell below!</p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[7]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">experiment_container_one</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="n">experiment_container_one</span><span class="p">[</span><span class="s1">&#39;cre_line&#39;</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="n">experiment_container_one</span><span class="p">[</span><span class="s1">&#39;specimen_name&#39;</span><span class="p">])</span>
  <span class="c1">#1 Can you print the value for the key, &#39;donor_name&#39; </span>
  <span class="c1">#2 Can you print the vlaue for the key, &#39;imaging_depth&#39; field</span>
  <span class="c1">#3 Can you print the value for the key, &#39;targeted_structure&#39; field</span>
  </pre></div>

  </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area"><div class="prompt"></div>
  <div class="output_subarea output_stream output_stdout output_text">
  <pre>566759225
  Cux2-CreERT2
  Cux2-CreERT2;Camk2a-tTA;Ai93-283284
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="3.-Retrieving-Experiment-Containers-Matching-Specific-Criteria">3. Retrieving <strong>Experiment Containers</strong> Matching Specific Criteria<a class="anchor-link" href="#3.-Retrieving-Experiment-Containers-Matching-Specific-Criteria"></a></h4><p>Earlier, you saw how to retrieve all <strong>Experiment Containers</strong> using the <em>get_experiment_containers()</em> method.</p>
  <p>Now, let's try retrieving <strong>Experiment Containers</strong> based on specific criteria.</p>
  <p>The criteria is as follows:</p>
  <ul>
  <li>the cells recorded from during experimentation must be from the VISp and VISam structures</li>
  <li>the imaging depth of the cells must be at 275</li>
  <li>the transgenic cre-line of the mice used must be Cux2-CreERT2</li>
  </ul>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
  </div>
  <div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <p>Luckily, the <em>get_experiment_containers()</em> method has paramaters that will take care of finding these specific <strong>Experiment Containers</strong>!</p>

  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[8]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython2"><pre><span></span><span class="n">specific_experiment_containers</span> <span class="o">=</span> <span class="n">boc</span><span class="o">.</span><span class="n">get_experiment_containers</span><span class="p">(</span><span class="n">targeted_structures</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VISp&#39;</span><span class="p">,</span><span class="s1">&#39;VISam&#39;</span><span class="p">],</span> <span class="n">imaging_depths</span><span class="o">=</span><span class="p">[</span><span class="mi">275</span><span class="p">],</span>
                                                                <span class="n">transgenic_lines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cux2-CreERT2&#39;</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">&quot;there are </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">specific_experiment_containers</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Experiment Containers matching this criteria&quot;</span><span class="p">)</span>
  </pre></div>

  </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area"><div class="prompt"></div>
  <div class="output_subarea output_stream output_stdout output_text">
  <pre>there are 10 Experiment Containers matching this criteria
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
      </div>
    </div>
  </body>
</html>
